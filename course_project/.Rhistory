# Libraries
library("ggplot2")
library("scales")
library("Hmisc")
# Set working directory
setwd("/Users/kjone332/Desktop/RStudio_Projects/GT-7406-StatisticalLearning/course_project")
# Read in training data
dat <- read.table(file="./data_files/train.csv", sep = ",", header=TRUE)
dat$LogSalePrice <- log(dat$SalePrice)
dat$TotalSquareFootage <- dat$TotalBsmtSF + dat$GrLivArea
dat$PricePerSqFoot <- dat$SalePrice/dat$TotalSquareFootage
dat$LogPricePerSqFoot <- dat$LogSalePrice/dat$TotalSquareFootage
View(dat)
dat$PricePerSqFoot
width_image <- 600
height_image <- 350
### Price per square foot by Neighborhood
unique_neighborhoods <- unique(as.character(dat$Neighborhood))
output <- matrix(ncol=3, nrow=25)
iterator <- 1
for (neighborhood in unique_neighborhoods){
temp_dat <- dat[dat$Neighborhood==neighborhood, ]
number_obs <- nrow(temp_dat)
output[iterator, 1] <- neighborhood
output[iterator, 2] <- median(temp_dat$LogPricePerSqFoot)
output[iterator, 3] <- number_obs
iterator <- iterator+1
}
ls
output <- as.data.frame(output)
View(output)
unique_neighborhoods <- unique(as.character(dat$Neighborhood))
output <- matrix(ncol=3, nrow=25)
iterator <- 1
for (neighborhood in unique_neighborhoods){
temp_dat <- dat[dat$Neighborhood==neighborhood, ]
number_obs <- nrow(temp_dat)
output[iterator, 1] <- neighborhood
output[iterator, 2] <- median(temp_dat$PricePerSqFoot)
output[iterator, 3] <- number_obs
iterator <- iterator+1
}
# Convert to dataframe
output <- as.data.frame(output)
View(output)
View(output)
View(output)
colnames(output) <- c("neighborhood", 'ppsqft', 'n')
View(output)
transform(output, ppsqft = as.numeric(ppsqft), n = as.numeric(n))
output <- transform(output, ppsqft = as.numeric(ppsqft), n = as.numeric(n))
View(output)
output[output$ppsqft == max(output$ppsqft)]
max(output$ppsqft)
output[output$ppsqft == max(output$ppsqft), "ppsqft"]
output[output$ppsqft == max(output$ppsqft), "neighborhood"]
min_neighborhood <- output[output$ppsqft == min(output$ppsqft), "neighborhood"]
max_neighborhood <- output[output$ppsqft == max(output$ppsqft), "neighborhood"]
plot_df <- rbind(dat[dat$Neighborhood==max_neighborhood, c("neighborhood", "ppsqft")],
dat[dat$Neighborhood==min_neighborhood, c("neighborhood", "ppsqft")])
plot_df <- rbind(dat[dat$Neighborhood==max_neighborhood, c("Neighborhood", "PricePerSqFoot")],
dat[dat$Neighborhood==min_neighborhood, c("Neighborhood", "PricePerSqFoot")])
View(plot_df)
plot_df
ggplot(plot_df, aes(x = Neighborhood, y = PricePerSqFoot, colour = Neighborhood)) +
geom_boxplot() +
theme_bw(base_size = 12) +
ylab("Price per Square Foot")
ggplot(plot_df, aes(x = Neighborhood, y = PricePerSqFoot, colour = Neighborhood)) +
geom_boxplot() +
theme_bw(base_size = 12) +
ylab("Price per Square Foot") +
scale_y_continuous(labels=function(x) paste0('$',x))
jpeg(file="./exploratory/images/price_psf_by_neighborhood.jpeg",
width=width_image, height=height_image)
ggplot(plot_df, aes(x = Neighborhood, y = PricePerSqFoot, colour = Neighborhood)) +
geom_boxplot() +
theme_bw(base_size = 12) +
ylab("Price per Square Foot") +
scale_y_continuous(labels=function(x) paste0('$',x))
dev.off()
jpeg(file="./exploratory/images/price_psf_by_neighborhood.jpeg",
width=width_image, height=height_image)
ggplot(plot_df, aes(x = Neighborhood, y = PricePerSqFoot, colour = Neighborhood)) +
geom_boxplot() +
theme_bw(base_size = 16) +
ylab("Price per Square Foot") +
scale_y_continuous(labels=function(x) paste0('$',x))
dev.off()
dat[dat$TotalSquareFootage>7000, c("TotalSquareFootage")]
ggplot(dat[dat$TotalSquareFootage>7000, ], aes(TotalSquareFootage, LogSalePrice)) +
geom_point(color='red') +
geom_smooth(method='lm') +
geom_text(x = 1500, y = 15.25, label = "r2 = 0.60") +
xlab("Total Square Footage") +
ylab("Log of Sale Price") +
theme_bw(base_size = 16)
ggplot(dat[dat$TotalSquareFootage<7000, ], aes(TotalSquareFootage, LogSalePrice)) +
geom_point(color='red') +
geom_smooth(method='lm') +
geom_text(x = 1500, y = 15.25, label = "r2 = 0.60") +
xlab("Total Square Footage") +
ylab("Log of Sale Price") +
theme_bw(base_size = 16)
ggplot(dat[dat$TotalSquareFootage<7000, ], aes(TotalSquareFootage, LogSalePrice)) +
geom_point(color='red') +
geom_smooth(method='lm') +
geom_text(x = 1500, y = 13.5, label = "r2 = 0.60") +
xlab("Total Square Footage") +
ylab("Log of Sale Price") +
theme_bw(base_size = 16)
lm(LogSalePrice~TotalSquareFootage, dat[dat$TotalSquareFootage<7000, ])
mod <- lm(LogSalePrice~TotalSquareFootage, dat[dat$TotalSquareFootage<7000, ])
summary(mod)
ggplot(dat[dat$TotalSquareFootage<7000, ], aes(TotalSquareFootage, LogSalePrice)) +
geom_point(color='red') +
geom_smooth(method='lm') +
geom_text(x = 1500, y = 13.5, label = "r2 = 0.67") +
xlab("Total Square Footage") +
ylab("Log of Sale Price") +
theme_bw(base_size = 16)
jpeg(file="./exploratory/images/square_footage_basic_wo_outliers.jpeg",
width=width_image, height=height_image)
ggplot(dat[dat$TotalSquareFootage<7000, ], aes(TotalSquareFootage, LogSalePrice)) +
geom_point(color='red') +
geom_smooth(method='lm') +
geom_text(x = 1500, y = 13.5, label = "r2 = 0.67") +
xlab("Total Square Footage") +
ylab("Log of Sale Price") +
theme_bw(base_size = 16)
dev.off()
